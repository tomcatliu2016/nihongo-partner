# Product Requirements Document (PRD)

## NihongoPartner

**Agentic AI 日语学习助手**

---

## 1. 项目概述

### 1.1 项目简介

NihongoPartner 是一个基于 Google Cloud AI 的自主式日语学习 Agent，通过真实场景对话练习、智能分析和个性化推荐，帮助外国学习者高效提升日语会话能力。

### 1.2 核心价值主张

| 价值 | 描述 |
|------|------|
| **自主决策** | Agent 根据用户表现自主调整教学策略，无需人工干预 |
| **实时互动** | 语音对话练习，模拟真实场景 |
| **个性化学习** | 基于用户薄弱点生成定制化学习材料和练习路径 |

### 1.3 Hackathon 目标

- 展示 Gemini 在多语言理解和自主决策上的能力
- 体现 Agent 的"自主性"（Agentic 特性）
- 满足 Google Cloud 技术要求，完成可在线体验的 MVP

> 📝 **说明**：本次 Hackathon 为在线提交形式，无需现场答辩。提交物包括代码仓库、产品文档和演示视频。

### 1.4 长期愿景

NihongoPartner 不仅是 Hackathon 参赛作品，更是一个长期发展的产品。Hackathon 后将持续迭代：

- **短期（1-2 月）**：完善核心功能，优化用户体验
- **中期（3-6 月）**：扩展场景库，增加社交功能
- **长期（6 月+）**：商业化运营，覆盖更多语种

### 1.5 多语言支持

应用界面支持三种语言，用户可自由切换：

| 语言 | 代码 | 说明 |
|------|------|------|
| 简体中文 | zh | 默认语言 |
| 日语 | ja | 适合高级学习者 |
| 英语 | en | 国际用户 |

---

## 2. 市场分析

### 2.1 目标市场

**主要市场**：
- 中国赴日留学生和工作者
- 全球日语学习者（以亚太地区为主）

**市场规模**：
- 全球日语学习者约 380 万人（2023 年 JLPT 报名数据）
- 中国是最大的日语学习市场，占比约 30%

### 2.2 竞品分析

| 竞品 | 优势 | 劣势 | 我们的差异化 |
|------|------|------|--------------|
| **Duolingo** | 游戏化设计、用户基数大 | 缺乏真实对话练习、无语音交互 | 真实场景对话、语音互动 |
| **HelloTalk** | 真人语伴、社交属性 | 依赖真人时间、质量不稳定 | 24/7 可用、AI 一致性 |
| **JapanesePod101** | 内容丰富、专业性强 | 被动学习、缺乏互动 | 主动练习、即时反馈 |
| **Rosetta Stone** | 沉浸式学习 | 价格高、缺乏个性化 | AI 个性化、按需生成内容 |
| **italki** | 真人外教、灵活 | 费用高、需预约 | 免费/低价、随时可用 |

**我们的核心差异化**：
1. **Agentic AI** - 自主决策的 AI 教练，而非简单问答
2. **实时语音对话** - 模拟真实场景，克服"哑巴日语"
3. **智能诊断** - 自动识别薄弱点，针对性提升
4. **按需生成** - 学习材料实时生成，真正个性化

---

## 3. 目标用户

### 3.1 用户画像

**画像 1：学习中的留学生**
- 年龄：20-30 岁
- 日语水平：N5-N4
- 痛点：课堂学习缺乏实践机会，不敢开口说
- 需求：真实场景会话练习，即时反馈
- 使用场景：课后练习、考前冲刺

**画像 2：计划赴日工作者**
- 年龄：25-35 岁
- 日语水平：N4-N3
- 痛点：商务场景应对不熟练，缺乏针对性训练
- 需求：特定场景深度练习，快速提升
- 使用场景：面试准备、商务沟通练习

**画像 3：自学爱好者**
- 年龄：18-45 岁
- 日语水平：N5 及以下
- 痛点：缺乏学习规划，不知道薄弱点在哪
- 需求：智能诊断，个性化学习路径
- 使用场景：兴趣学习、旅行准备

### 3.2 用户旅程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           用户旅程图                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐         │
│  │  发现    │ -> │  注册    │ -> │  评估    │ -> │  首次    │         │
│  │  应用    │    │  登录    │    │  水平    │    │  练习    │         │
│  └──────────┘    └──────────┘    └──────────┘    └──────────┘         │
│       │               │               │               │                │
│       v               v               v               v                │
│  [广告/推荐]    [手机号/社交]   [简短测试]      [引导场景]             │
│                                    5分钟           餐厅点餐              │
│                                                                         │
│       ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐   │
│       │  查看    │ <- │  完成    │ <- │  对话    │ <- │  选择    │   │
│       │  报告    │    │  练习    │    │  练习    │    │  场景    │   │
│       └──────────┘    └──────────┘    └──────────┘    └──────────┘   │
│            │               │               │               │           │
│            v               v               v               v           │
│       [错误分析]      [5-8轮对话]     [语音/文字]     [今日推荐]       │
│       [学习建议]      [Agent评估]     [实时反馈]     [难度选择]       │
│                                                                         │
│       ┌──────────┐    ┌──────────┐    ┌──────────┐                    │
│       │  学习    │ -> │  再次    │ -> │  长期    │                    │
│       │  材料    │    │  练习    │    │  追踪    │                    │
│       └──────────┘    └──────────┘    └──────────┘                    │
│            │               │               │                           │
│            v               v               v                           │
│       [针对性内容]    [新场景/更高难度] [进步曲线]                     │
│       [练习题]                        [成就系统]                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 功能需求

### 4.1 核心功能（MVP - Must Have）

#### 功能 1：场景对话练习 🎯 **最高优先级**

**功能描述**

用户选择生活场景，与 AI Agent 进行真实对话练习。Agent 扮演场景中的角色（如服务员、店员），用户用日语与其互动。

**Agent 自主行为**
- 实时评估用户日语水平
- 根据表现自主调整对话难度
- 判断何时提供提示或帮助
- 决定何时结束当前场景

**支持场景（MVP）**

| 场景 | 角色 | 典型对话内容 | 难度范围 |
|------|------|--------------|----------|
| 餐厅点餐 | 服务员 | 点菜、询问推荐、结账 | 1-5 |
| 购物 | 店员 | 询价、试穿、付款 | 1-5 |
| 自我介绍 | 面试官/新同事 | 基本信息、兴趣爱好、工作经历 | 1-5 |

**用户故事**
```
作为一个日语学习者
我想要在餐厅点餐场景中练习对话
以便在真实情况下能够流利应对
```

**验收标准**
- [ ] 支持 3 个基础场景（餐厅、购物、自我介绍）
- [ ] 支持语音输入和文字输入
- [ ] Agent 语音回复（可调语速）
- [ ] 对话过程中 Agent 能自主决定是否给提示
- [ ] Agent 能识别用户错误但不打断对话流程
- [ ] 单次对话 5-8 轮交互
- [ ] 对话响应时间 < 3 秒

**交互流程**
```
用户选择场景 -> 选择难度 -> 开始对话
                              ↓
              ┌───────────────────────────────┐
              │  用户输入（语音/文字）          │
              │         ↓                      │
              │  Agent 分析（语法、词汇、语境） │
              │         ↓                      │
              │  Agent 自主决策                │
              │  - 继续对话                    │
              │  - 降低难度 + 提示             │
              │  - 提高难度                    │
              │  - 纠正错误                    │
              │  - 结束对话                    │
              │         ↓                      │
              │  Agent 回应（语音 + 文字）     │
              └───────────────────────────────┘
                              ↓
                        对话结束 -> 生成分析报告
```

---

#### 功能 2：智能学习分析 🎯 **高优先级**

**功能描述**

对话结束后，Agent 自动分析用户表现，识别薄弱点，生成学习报告。

**Agent 自主行为**
- 统计和分类错误类型
- 识别语法薄弱点
- 评估整体进步趋势
- 自主生成改进建议

**用户故事**
```
作为一个日语学习者
我想要了解自己哪里做得不好
以便有针对性地改进
```

**验收标准**
- [ ] 显示对话中的主要错误（3-5 个）
- [ ] 分类错误类型（语法/词汇/语序等）
- [ ] 提供具体改进建议
- [ ] 显示做得好的地方（正向激励）
- [ ] 生成可视化的评分

**分析报告结构**
```
📊 对话分析报告

综合评分：78/100  ⭐⭐⭐⭐

✅ 做得好：
• 礼貌用语使用正确（です/ます形）
• 基础词汇掌握扎实

⚠️ 需要改进：
• 助词「に」「で」混淆（错误 3 次）
  - ✗ レストランに食べます
  - ✓ レストランで食べます
• 动词て形变形不熟练（错误 2 次）

💡 Agent 建议：
重点复习助词用法，我已为你准备了专项练习内容。
建议明天练习「购物」场景，继续巩固助词使用。

[查看学习材料] [再练一次] [换个场景]
```

---

#### 功能 3：个性化学习材料 🎯 **高优先级**

**功能描述**

根据用户薄弱点，Agent 实时生成针对性学习材料。

**Agent 自主行为**
- 基于薄弱点实时生成讲解内容
- 创建针对性练习题
- 推荐外部学习资源
- 难度匹配用户水平

**用户故事**
```
作为一个日语学习者
我想要针对我的薄弱点获得学习材料
以便快速提升
```

**验收标准**
- [ ] 生成简明语法讲解（用户界面语言）
- [ ] 提供例句（3-5 个，由易到难）
- [ ] 生成针对性练习题（3-5 题）
- [ ] 推荐外部资源（2-3 个链接）
- [ ] 材料生成时间 < 5 秒

**生成内容结构**
```
# 助词「に」和「で」的区别

## 核心讲解
「に」表示目的地或时间点
「で」表示动作发生的场所或方式

## 例句
1. 学校に行きます（去学校 - 目的地）
2. 教室で勉強します（在教室学习 - 场所）
3. 7時に起きます（7点起床 - 时间点）
4. バスで行きます（坐公交去 - 方式）

## 练习题
1. 明日、図書館___本を借ります。
   A) に  B) で  C) を

## 推荐资源
- [视频] Tae Kim's Grammar Guide - Particles
- [练习] JLPT Sensei - に/で 练习
```

---

#### 功能 4：学习路径推荐 🎯 **中优先级**

**功能描述**

Agent 维护用户档案，自主推荐下次应该练习的内容。

**Agent 自主行为**
- 跟踪学习历史和进度
- 分析薄弱点分布
- 推荐最佳练习顺序
- 评估合适的难度级别

**用户故事**
```
作为一个日语学习者
我想要知道接下来应该学什么
以便有计划地提升
```

**验收标准**
- [ ] 每次打开应用显示"今日推荐"
- [ ] 推荐包含场景选择和难度
- [ ] 说明推荐理由
- [ ] 允许用户自主选择其他内容
- [ ] 推荐基于至少最近 3 次练习数据

**推荐卡片示例**
```
🎯 今日推荐

场景：购物
难度：⭐⭐⭐ (3/5)

推荐理由：
• 上次「餐厅」场景表现不错（82分）
• 但助词使用仍需加强
• 「购物」场景有更多助词练习机会

[开始练习] [选择其他场景]
```

---

### 4.2 扩展功能（Nice to Have）

#### 扩展 1：多模态学习
- 图片场景展示（AI 生成）
- 手写日语识别
- 视频资源集成

#### 扩展 2：进度追踪
- 学习日历和连续天数
- 成就系统和徽章
- 水平测试（模拟 JLPT）

#### 扩展 3：社交功能
- 学习小组匹配
- 排行榜
- 练习录音分享

---

## 5. 场景内容设计

### 5.1 餐厅点餐场景

**场景设定**
- 地点：日式餐厅
- Agent 角色：服务员（店員）
- 用户角色：顾客

**难度分级**

| 难度 | 对话复杂度 | 词汇范围 | 语法要求 |
|------|------------|----------|----------|
| 1 | 简单点单 | 基础食物名称 | です/ます |
| 2 | 询问推荐 | 形容词、数量词 | ～てください |
| 3 | 特殊要求 | 调味料、过敏 | ～ないでください |
| 4 | 复杂交流 | 套餐、优惠 | 敬语基础 |
| 5 | 自然对话 | 惯用表达 | 敬语进阶 |

**典型对话流程**

```
难度 1 示例：

Agent: いらっしゃいませ。何名様ですか。
       (欢迎光临。请问几位？)

User:  一人です。
       (一个人。)

Agent: かしこまりました。こちらへどうぞ。
       ご注文はお決まりですか。
       (好的。这边请。请问要点什么？)

User:  ラーメンをください。
       (请给我拉面。)

Agent: かしこまりました。お飲み物はいかがですか。
       (好的。需要饮料吗？)
```

### 5.2 购物场景

**场景设定**
- 地点：服装店 / 便利店 / 电器店
- Agent 角色：店员
- 用户角色：顾客

**典型话题**
- 询问价格
- 询问尺寸/颜色
- 试穿/试用
- 付款方式
- 退换货

### 5.3 自我介绍场景

**场景设定**
- 地点：面试室 / 新公司 / 学校
- Agent 角色：面试官 / 新同事 / 老师
- 用户角色：求职者 / 新员工 / 学生

**典型话题**
- 基本信息（姓名、年龄、出身）
- 学习/工作经历
- 兴趣爱好
- 学习日语的理由
- 未来计划

---

## 6. 技术架构概述

> 详细技术规范请参阅 [技术栈文档](./docs/TECH_STACK.md)

### 6.1 系统架构

```
┌─────────────────────────────────────────────────┐
│              用户界面 (Web App)                  │
│         Next.js 16 + React 19 + TypeScript       │
│              支持语音输入/输出                    │
└─────────────────────┬───────────────────────────┘
                      │ HTTPS / WebSocket
┌─────────────────────▼───────────────────────────┐
│              应用服务 (Cloud Run)                │
│  ┌─────────────────────────────────────────┐   │
│  │           Agent 决策引擎                 │   │
│  │  • 对话管理  • 学习分析  • 材料生成      │   │
│  └─────────────────────────────────────────┘   │
└─────────────────────┬───────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────┐
│            Google Cloud AI 服务                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │ Gemini   │  │ Speech   │  │ Firestore│      │
│  │ (AI核心) │  │ (语音)   │  │ (数据)   │      │
│  └──────────┘  └──────────┘  └──────────┘      │
└─────────────────────────────────────────────────┘
```

### 6.2 核心 Google Cloud 服务

| 服务 | 用途 |
|------|------|
| **Vertex AI (Gemini)** | 对话理解、决策、内容生成 |
| **Speech-to-Text** | 日语语音识别 |
| **Text-to-Speech** | 日语语音合成 |
| **Firestore** | 用户数据、学习历史存储 |
| **Cloud Run** | 应用部署 |

### 6.3 数据模型概述

**用户档案**
- 基本信息（ID、注册时间、语言偏好）
- 日语水平（N5-N1）
- 学习统计（总时长、准确率）
- 薄弱点列表
- 学习历史

**对话会话**
- 会话信息（场景、难度、时间）
- 消息记录（角色、内容、时间戳）
- Agent 分析结果

**学习材料**
- 针对主题
- 讲解内容
- 练习题
- 推荐资源

---

## 7. 开发计划

### 7.1 Hackathon 阶段（在线提交）

| 阶段 | 时间 | 主要任务 |
|------|------|----------|
| **Day 1** | 8-10h | 基础架构搭建、核心对话功能 |
| **Day 2** | 8-10h | Agent 智能化、语音功能、分析报告 |
| **Day 3** | 8-10h | 完善体验、测试调试、录制演示视频 |

### 7.2 Hackathon 后迭代计划

| 阶段 | 时间 | 目标 |
|------|------|------|
| **Phase 1** | 第 1-2 周 | 根据反馈优化核心体验、修复 Bug |
| **Phase 2** | 第 3-4 周 | 扩展至 5+ 场景、完善用户系统 |
| **Phase 3** | 第 2 月 | 社交功能、学习社区基础版 |
| **Phase 4** | 第 3 月 | 商业化准备、付费功能上线 |

### 7.3 任务优先级（Hackathon）

**P0 - 必须完成（MVP 核心）**
- 1 个场景的对话功能（餐厅）
- Agent 基本决策能力
- 语音输入/输出
- 对话分析报告
- 学习材料生成（至少 1 个示例）
- 基础 UI

**P1 - 重要（增强体验）**
- 3 个场景
- 用户档案系统
- 个性化推荐
- 难度自动调整
- 美观的 UI 设计

**P2 - 加分（时间允许）**
- 更多场景
- 进度可视化
- 多模态内容

---

## 8. 商业模式

> 📝 Hackathon 阶段专注于产品验证，商业化将在后续迭代中逐步实现。

### 8.1 盈利策略

| 模式 | 描述 | 定价参考 |
|------|------|----------|
| **免费版** | 每日 3 次对话、基础场景 | 免费 |
| **订阅版** | 无限对话、全部场景、高级分析 | ¥29/月 |
| **企业版** | 定制场景、员工管理、API 接入 | 按需定价 |

### 8.2 关键指标

**用户增长指标**
- DAU / MAU
- 新用户注册数
- 用户留存率（D1/D7/D30）

**产品质量指标**
- 对话完成率
- 分析报告查看率
- 学习材料使用率
- 用户评分

**商业指标**
- 付费转化率
- ARPU（每用户平均收入）
- LTV（用户生命周期价值）

---

## 9. 风险与应对

### 9.1 技术风险

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| Gemini API 限流 | 高 | 中 | 申请更高配额；请求队列；降级方案 |
| 语音识别准确度低 | 中 | 中 | 同时支持文字输入；优化音频预处理 |
| Cloud Run 冷启动慢 | 中 | 高 | 保持最小实例运行；配置预热机制 |

### 9.2 产品风险

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 用户不会说日语 | 高 | 中 | 提供提示功能；支持拼音输入 |
| 对话不自然 | 中 | 中 | 优化 Prompt；收集反馈迭代 |
| 分析不准确 | 中 | 低 | 人工审核样本；持续优化模型 |

### 9.3 提交风险

| 风险 | 应对策略 |
|------|----------|
| 演示视频质量 | 多次录制，选择最佳版本；准备备用环境 |
| 在线服务稳定性 | 评审期间保持服务可用；监控告警 |
| 功能演示不完整 | 视频覆盖所有核心功能；提供在线试用入口 |

---

## 10. 数据隐私

### 10.1 数据收集

| 数据类型 | 用途 | 存储期限 |
|----------|------|----------|
| 用户基本信息 | 账号管理 | 账号存续期间 |
| 对话记录 | 学习分析、个性化推荐 | 可由用户删除 |
| 语音数据 | 转写后即删除 | 不持久存储 |
| 学习统计 | 进度追踪 | 账号存续期间 |

### 10.2 隐私保护措施

- 所有数据传输使用 HTTPS 加密
- 用户可随时导出或删除个人数据
- 不向第三方出售用户数据
- 遵循 GDPR 和中国个人信息保护法

---

## 11. 演示视频脚本

> 📝 本次 Hackathon 为在线提交，需要提供演示视频。以下为视频脚本。

### 11.1 视频结构（3-5 分钟）

**开场（30 秒）**
```
NihongoPartner - 你的 AI 日语学习伙伴

学日语最大的挑战：
• 缺乏真实对话练习
• 不知道薄弱点在哪
• 没有个性化指导

NihongoPartner 用 Agentic AI 解决这些问题。
```

**核心功能演示（2-3 分钟）**
```
【功能 1：智能对话】（60 秒）
• 展示场景选择界面
• 演示餐厅点餐对话（语音交互）
• 展示 Agent 如何智能应对错误

【功能 2：学习分析】（45 秒）
• 展示对话分析报告
• 错误识别和改进建议
• Agent 推荐的下一步学习

【功能 3：个性化材料】（30 秒）
• 针对薄弱点生成的学习内容
• 练习题和推荐资源
```

**技术亮点（45 秒）**
```
Google Cloud 技术栈：
• Gemini - 对话理解、自主决策、内容生成
• Speech APIs - 实时语音识别和合成
• Cloud Run - 稳定部署，支持实时交互

关键特性：Agentic AI
• 自主评估用户水平
• 自主调整教学策略
• 自主生成个性化内容
```

**结尾（30 秒）**
```
NihongoPartner 让每个人都有专属的 AI 日语教练。

欢迎访问试用：[在线体验地址]
```

### 11.2 视频制作要点

| 要点 | 说明 |
|------|------|
| 画质 | 1080p 以上，清晰展示界面 |
| 配音 | 普通话或英语，配字幕 |
| 节奏 | 避免冗长操作，保持流畅 |
| 重点 | 突出 Agent 自主决策能力 |

---

## 12. 交付物

### 12.1 代码仓库

详见 [技术栈文档 - 项目结构](./docs/TECH_STACK.md#项目结构)

### 12.2 文档清单

| 文档 | 路径 | 描述 |
|------|------|------|
| 产品需求文档 | `NihongoPartner.md` | 本文档 |
| 技术栈文档 | `docs/TECH_STACK.md` | 技术选型、架构、部署 |
| 前端开发规范 | `docs/FRONTEND_GUIDELINES.md` | 组件、样式、状态管理规范 |
| API 开发规范 | `docs/API_GUIDELINES.md` | 接口设计、错误处理规范 |
| 项目通用规范 | `docs/PROJECT_GUIDELINES.md` | Git、代码风格、发布流程 |

### 12.3 Hackathon 提交物

| 提交物 | 要求 | 状态 |
|--------|------|------|
| 代码仓库 | GitHub 公开仓库，含 README | [ ] |
| 演示视频 | 3-5 分钟，展示核心功能 | [ ] |
| 在线体验 | 可访问的部署地址 | [ ] |
| 产品文档 | 本 PRD 及技术文档 | [ ] |

---

## 13. 附录

### 13.1 关键决策记录

**决策 1：为什么选日语学习而非其他语言？**
- 日本本地市场需求更强
- 多模态能力（语音）发挥空间更大
- 日语语法复杂度适合展示 AI 分析能力

**决策 2：为什么用 Cloud Run 而非 Cloud Functions？**
- 需要维护对话状态（有状态服务）
- WebSocket 支持（实时语音）
- 更灵活的部署方式

**决策 3：为什么生成材料而非预置？**
- 节省开发时间
- 展示 AI 能力
- 真正个性化

### 13.2 参考资源

**日语学习资源**
- JLPT 官网: https://www.jlpt.jp/
- Tae Kim's Guide: https://guidetojapanese.org/

**Google Cloud 文档**
- Vertex AI: https://cloud.google.com/vertex-ai/docs
- Speech-to-Text: https://cloud.google.com/speech-to-text/docs
- Cloud Run: https://cloud.google.com/run/docs

---

## PRD 签署

| 角色 | 姓名 | 日期 | 签名 |
|------|------|------|------|
| 产品负责人 | [姓名] | 2026-01-17 | ✓ |
| 技术负责人 | [姓名] | 2026-01-17 | ✓ |

---

**版本历史**

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2026-01-14 | 初始版本 |
| v2.0 | 2026-01-17 | 重构：简化技术部分、补充产品内容（竞品分析、用户旅程、商业模式、场景设计） |
| v2.1 | 2026-01-17 | 调整 Hackathon 相关内容（在线提交、无答辩）；增加长期规划 |
